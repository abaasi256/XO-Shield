<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XO-SHIELD // ORBIT STATUS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');

        body {
            font-family: 'JetBrains Mono', monospace;
        }

        .glow-text {
            text-shadow: 0 0 20px currentColor;
        }

        .gauge-bg {
            fill: none;
            stroke: #1e293b;
            /* slate-800 */
            stroke-width: 8;
            stroke-linecap: round;
        }

        .gauge-value {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease-in-out, stroke 0.5s ease;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        @keyframes scan {
            0% {
                transform: translateY(-100%);
            }

            100% {
                transform: translateY(100%);
            }
        }

        .animate-scan {
            animation: scan 3s linear infinite;
        }
    </style>
</head>

<body
    class="bg-slate-950 text-slate-200 min-h-screen flex items-center justify-center p-4 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-black">

    <div class="max-w-md w-full space-y-8 relative">
        <!-- Background decorative elements -->
        <div class="absolute -top-20 -left-20 w-64 h-64 bg-cyan-500/10 rounded-full blur-3xl pointer-events-none"></div>
        <div class="absolute -bottom-20 -right-20 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl pointer-events-none">
        </div>

        <div class="text-center space-y-2 relative z-10">
            <h1
                class="text-4xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">
                XO-SHIELD
            </h1>
            <p class="text-xs font-mono text-slate-500 uppercase tracking-[0.2em]">Real-time Security Engine</p>
        </div>

        <div class="glass-panel rounded-3xl p-8 relative overflow-hidden">
            <!-- Scan line effect -->
            <div
                class="absolute inset-0 bg-gradient-to-b from-transparent via-cyan-500/5 to-transparent opacity-20 animate-scan pointer-events-none">
            </div>

            <!-- Gauge Container -->
            <div class="relative w-64 h-64 mx-auto mb-8">
                <svg class="w-full h-full" viewBox="0 0 100 100">
                    <!-- Background Circle -->
                    <circle class="gauge-bg" cx="50" cy="50" r="40"></circle>
                    <!-- Progress Circle -->
                    <circle id="gauge-progress" class="gauge-value" cx="50" cy="50" r="40" stroke-dasharray="251.3"
                        stroke-dashoffset="251.3" stroke="currentColor"></circle>
                </svg>

                <!-- Center Score Text -->
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                    <span id="score-value"
                        class="text-6xl font-bold font-mono glow-text transition-colors duration-500">--</span>
                    <span class="text-xs text-slate-500 uppercase tracking-wider mt-1">Security Score</span>
                </div>
            </div>

            <!-- Status List -->
            <div class="space-y-3">
                <!-- WireGuard -->
                <div
                    class="flex items-center justify-between p-3 rounded-xl bg-slate-900/50 border border-slate-800/50 transition-all hover:border-slate-700">
                    <div class="flex items-center space-x-3">
                        <div id="icon-wg" class="w-2 h-2 rounded-full bg-slate-600"></div>
                        <span class="text-sm font-medium text-slate-300">WireGuard Tunnel</span>
                    </div>
                    <span id="status-wg" class="text-lg">--</span>
                </div>

                <!-- Firewall -->
                <div
                    class="flex items-center justify-between p-3 rounded-xl bg-slate-900/50 border border-slate-800/50 transition-all hover:border-slate-700">
                    <div class="flex items-center space-x-3">
                        <div id="icon-ufw" class="w-2 h-2 rounded-full bg-slate-600"></div>
                        <span class="text-sm font-medium text-slate-300">Firewall (UFW)</span>
                    </div>
                    <span id="status-ufw" class="text-lg">--</span>
                </div>

                <!-- Latency -->
                <div
                    class="flex items-center justify-between p-3 rounded-xl bg-slate-900/50 border border-slate-800/50 transition-all hover:border-slate-700">
                    <div class="flex items-center space-x-3">
                        <div id="icon-latency" class="w-2 h-2 rounded-full bg-slate-600"></div>
                        <span class="text-sm font-medium text-slate-300">Network Latency</span>
                    </div>
                    <span id="status-latency" class="text-lg">--</span>
                </div>
            </div>

            <div class="mt-6 text-center">
                <p class="text-[10px] text-slate-600">Last updated: <span id="last-updated">Never</span></p>
            </div>
        </div>
    </div>

    <script>
        const CIRCUMFERENCE = 251.3; // 2 * pi * 40

        function updateGauge(score) {
            const progress = document.getElementById('gauge-progress');
            const scoreValue = document.getElementById('score-value');

            // Calculate offset
            const offset = CIRCUMFERENCE - (score / 100) * CIRCUMFERENCE;
            progress.style.strokeDashoffset = offset;

            // Update text
            scoreValue.textContent = score;

            // Color Logic
            let colorClass = '';
            let colorHex = '';

            if (score > 90) {
                colorClass = 'text-emerald-400';
                colorHex = '#34d399'; // emerald-400
            } else if (score >= 50) {
                colorClass = 'text-yellow-400';
                colorHex = '#facc15'; // yellow-400
            } else {
                colorClass = 'text-rose-500';
                colorHex = '#f43f5e'; // rose-500
            }

            // Reset classes and add new one
            scoreValue.className = `text-6xl font-bold font-mono glow-text transition-colors duration-500 ${colorClass}`;
            progress.style.stroke = colorHex;
            progress.style.filter = `drop-shadow(0 0 8px ${colorHex})`;
        }

        function updateStatusItem(idSuffix, isOk, textValue) {
            const statusEl = document.getElementById(`status-${idSuffix}`);
            const iconEl = document.getElementById(`icon-${idSuffix}`);

            if (isOk) {
                statusEl.textContent = '✅';
                if (textValue) statusEl.textContent = textValue; // Use text value if provided, or just checkmark

                // For latency, we want to show the ms
                if (idSuffix === 'latency') {
                    statusEl.textContent = textValue;
                    statusEl.classList.add('text-emerald-400');
                    statusEl.classList.remove('text-rose-500');
                }

                iconEl.className = 'w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]';
            } else {
                statusEl.textContent = '❌';
                if (idSuffix === 'latency') {
                    statusEl.textContent = textValue;
                    statusEl.classList.add('text-rose-500');
                    statusEl.classList.remove('text-emerald-400');
                }
                iconEl.className = 'w-2 h-2 rounded-full bg-rose-500 shadow-[0_0_8px_rgba(244,63,94,0.6)]';
            }
        }

        async function fetchStatus() {
            try {
                const response = await fetch('/api/status');
                const data = await response.json();

                updateGauge(data.score);

                // WireGuard
                const wgUp = data.vpn_status === 'UP';
                updateStatusItem('wg', wgUp, wgUp ? 'Active' : 'Inactive');

                // Firewall
                const fwActive = data.firewall_status === 'ACTIVE';
                updateStatusItem('ufw', fwActive, fwActive ? 'Active' : 'Inactive');

                // Latency
                const latencyOk = data.latency_ms < 100;
                updateStatusItem('latency', latencyOk, data.latency_ms + 'ms');

                const now = new Date();
                document.getElementById('last-updated').textContent = now.toLocaleTimeString();

            } catch (error) {
                console.error('Error fetching status:', error);
            }
        }

        // Poll every 5 seconds
        setInterval(fetchStatus, 5000);

        // Initial fetch
        fetchStatus();
    </script>
</body>

</html>